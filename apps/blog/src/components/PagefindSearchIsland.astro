---
interface Props {
  assetPath: string;
  placeholder: string;
}

const { assetPath, placeholder }: Props = Astro.props;
const normalizedPath = assetPath.replace(/\/$/, "");
const elementId = "pagefind-search";
const script = `import('${normalizedPath}/pagefind-ui.js')
  .then((module) => {
    const PagefindUI = module?.default;
    if (!PagefindUI) {
      throw new Error('PagefindUI is unavailable');
    }
    new PagefindUI({
      element: '#${elementId}',
      showImages: false,
      showSubResults: true,
      translations: { placeholder: ${JSON.stringify(placeholder)} }
    });
  })
  .catch((error) => {
    console.error('Failed to initialize Pagefind UI', error);
  });`;
---

<div id={elementId}></div>
<script type="module" is:inline>
  {
    script;
  }
</script>
